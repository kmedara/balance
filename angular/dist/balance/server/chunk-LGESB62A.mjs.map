{
  "version": 3,
  "sources": ["src/app/modals/modal.service.ts"],
  "sourcesContent": ["import {\r\n  ApplicationRef,\r\n  EnvironmentInjector,\r\n  Injectable,\r\n  Type,\r\n  createComponent,\r\n  createEnvironmentInjector,\r\n  inject,\r\n  signal,\r\n} from '@angular/core';\r\nimport { MODAL_CONFIG, MODAL_DATA, MODAL_ID, ModalConfig } from './modal.tokens';\r\nimport { ModalEvent } from '../types/events';\r\n\r\n/**\r\n * Tracks all modals, owns signals for “results” or lifecycle, knows nothing about DOM or components.\r\n */\r\n@Injectable({ providedIn: 'root' })\r\nexport class ModalService {\r\n  private readonly _results = signal<ModalEvent[]>([]);\r\n  readonly results = this._results.asReadonly();\r\n  private readonly rootEnvInjector = inject(EnvironmentInjector);\r\n  private readonly appRef = inject(ApplicationRef);\r\n\r\n  async open<T = unknown>(\r\n    content: Type<unknown>,\r\n    config: Partial<ModalConfig> = {},\r\n  ): Promise<string> {\r\n    const id = crypto.randomUUID();\r\n\r\n    const shellInjector = createEnvironmentInjector(\r\n      [\r\n        { provide: MODAL_ID, useValue: id },\r\n        { provide: MODAL_CONFIG, useValue: { content, ...config } },\r\n        { provide: MODAL_DATA, useValue: config.data ?? null },\r\n      ],\r\n      this.rootEnvInjector\r\n    );\r\n    const { ModalShell } = await import('./modal-shell/modal-shell').then(m => m);\r\n    const shellRef = createComponent(ModalShell, {\r\n      environmentInjector: shellInjector,\r\n    });\r\n\r\n    this.appRef.attachView(shellRef.hostView);\r\n    document.body.appendChild(shellRef.location.nativeElement);\r\n    this.emit({\r\n      id,\r\n      outcome: 'ModalOpened',\r\n    });\r\n    return id;\r\n  }\r\n\r\n  close<T>(event: ModalEvent) {\r\n    this.emit(event);\r\n  }\r\n\r\n  emit(event: ModalEvent) {\r\n    if (!event.payload)\r\n      delete event.payload;\r\n    this._results.update(events => [...events, event]);\r\n  }\r\n}\r\n"],
  "mappings": ";uLAiBA,IAAaA,GAAY,IAAA,CAAnB,MAAOA,CAAY,CACNC,SAAWC,EAAqB,CAAA,CAAE,EAC1CC,QAAU,KAAKF,SAASG,WAAU,EAC1BC,gBAAkBC,EAAOC,CAAmB,EAC5CC,OAASF,EAAOG,CAAc,EAE/C,MAAMC,KACJC,EACAC,EAA+B,CAAA,EAAE,CAEjC,IAAMC,EAAKC,OAAOC,WAAU,EAEtBC,EAAgBC,EACpB,CACE,CAAEC,QAASC,EAAUC,SAAUP,CAAE,EACjC,CAAEK,QAASG,EAAcD,SAAUE,EAAA,CAAEX,QAAAA,GAAYC,EAAQ,EACzD,CAAEM,QAASK,EAAYH,SAAUR,EAAOY,MAAQ,IAAI,CAAE,EAExD,KAAKnB,eAAe,EAEhB,CAAEoB,WAAAA,CAAU,EAAK,KAAM,QAAO,sBAA2B,EAAEC,KAAKC,GAAKA,CAAC,EACtEC,EAAWC,EAAgBJ,EAAY,CAC3CK,oBAAqBd,EACtB,EAED,YAAKR,OAAOuB,WAAWH,EAASI,QAAQ,EACxCC,SAASC,KAAKC,YAAYP,EAASQ,SAASC,aAAa,EACzD,KAAKC,KAAK,CACRzB,GAAAA,EACA0B,QAAS,cACV,EACM1B,CACT,CAEA2B,MAASC,EAAiB,CACxB,KAAKH,KAAKG,CAAK,CACjB,CAEAH,KAAKG,EAAiB,CACfA,EAAMC,SACT,OAAOD,EAAMC,QACf,KAAKzC,SAAS0C,OAAOC,GAAU,CAAC,GAAGA,EAAQH,CAAK,CAAC,CACnD,4CA1CWzC,EAAY,6BAAZA,EAAY6C,QAAZ7C,EAAY8C,UAAAC,WADC,MAAM,CAAA,SACnB/C,CAAY,GAAA",
  "names": ["ModalService", "_results", "signal", "results", "asReadonly", "rootEnvInjector", "inject", "EnvironmentInjector", "appRef", "ApplicationRef", "open", "content", "config", "id", "crypto", "randomUUID", "shellInjector", "createEnvironmentInjector", "provide", "MODAL_ID", "useValue", "MODAL_CONFIG", "__spreadValues", "MODAL_DATA", "data", "ModalShell", "then", "m", "shellRef", "createComponent", "environmentInjector", "attachView", "hostView", "document", "body", "appendChild", "location", "nativeElement", "emit", "outcome", "close", "event", "payload", "update", "events", "factory", "\u0275fac", "providedIn"]
}
